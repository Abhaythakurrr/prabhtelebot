# Proactive Messages Setup & Testing Guide

## What Are Proactive Messages?

Proactive messages are when Prabh reaches out to you first, without you messaging first. Like a real companion checking in on you! ðŸ’•

## Requirements

To receive proactive messages, you need:

1. **Subscription Tier**: Basic, Prime, or Lifetime (not Free)
2. **Bot Running**: The bot must be running continuously
3. **Time Interval**: Messages are sent every 2 hours (if you haven't chatted recently)

## How to Test Proactive Messages

### Step 1: Upgrade Your Account (For Testing)

Send this command to the bot:
```
/upgradetest
```

This will upgrade you to **Basic tier** for 30 days, which includes:
- âœ… Unlimited messages
- âœ… 100 images/month
- âœ… 10 videos/month
- âœ… **Proactive messages enabled**

### Step 2: Trigger a Test Message

Send this command to immediately receive a proactive message:
```
/testproactive
```

This will make Prabh send you a message right away, without waiting!

### Step 3: Wait for Automatic Messages

Once upgraded, Prabh will automatically reach out to you:
- **Every 2 hours** (if you haven't chatted)
- System checks **every 10 minutes** for users to message
- Messages are personalized based on your conversation history

## How It Works

### Automatic System
1. Bot checks every 10 minutes for users who should receive messages
2. If you have Basic+ tier and haven't received a message in 2 hours, you get one
3. Messages are generated using your conversation history and memories
4. Each message is unique and contextual

### Message Types
- Friendly check-ins: "Hey! How's your day going? ðŸ˜Š"
- Thoughtful questions: "I was thinking about you... what's on your mind?"
- Playful engagement: "Missing our chats! What are you up to? âœ¨"
- Emotional support: "Hope you're doing well today ðŸ’•"

## Troubleshooting

### "Proactive messages require Basic tier or higher"
**Solution**: Run `/upgradetest` to upgrade your account

### "Proactive system not initialized yet"
**Solution**: Wait 30 seconds after bot starts, then try `/testproactive` again

### Not receiving automatic messages
**Check**:
1. Is the bot running continuously? (not restarting)
2. Have you been upgraded? (run `/start` to check your tier)
3. Has it been 2+ hours since your last proactive message?
4. Try `/testproactive` to test manually

## Configuration

You can adjust these settings in `src/bot/proactive_system.py`:

```python
# Time between proactive messages (currently 2 hours)
timedelta(hours=2)

# Check interval (currently 10 minutes)
await asyncio.sleep(600)
```

## Production Recommendations

For production use:
- **Interval**: 4-6 hours between messages (avoid being annoying)
- **Check frequency**: 30 minutes (reduce server load)
- **Personalization**: Use user preferences for timing
- **Opt-out**: Add command to disable proactive messages
- **Smart timing**: Don't send messages at night (use user timezone)

## Commands Summary

| Command | Description |
|---------|-------------|
| `/upgradetest` | Upgrade to Basic tier (testing) |
| `/testproactive` | Get immediate proactive message |
| `/start` | Check your current tier and stats |
| `/premium` | View all subscription tiers |

## Example Flow

```
User: /upgradetest
Bot: âœ… Upgraded to BASIC tier!
     You now have proactive messages enabled!

User: /testproactive
Bot: ðŸ’• Hey! I was just thinking about you. How's your day going? ðŸ˜Š

[2 hours later, automatically]
Bot: ðŸ’• Missing our chats! What have you been up to? âœ¨

[2 hours later, automatically]
Bot: ðŸ’• Hope you're having a wonderful day! Anything exciting happening? ðŸ’•
```

## Notes

- Proactive messages use your conversation history for context
- Each message is unique and generated by AI
- Messages adapt to your personality and previous conversations
- System respects your tier limits and preferences
